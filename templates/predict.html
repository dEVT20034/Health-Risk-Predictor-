<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Start Prediction | HealthPredict</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background-color: #f0f9ff; font-family: 'Segoe UI', sans-serif; }
    .container { max-width: 750px; background: white; padding: 40px; margin-top: 60px; border-radius: 16px; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); }
    h2 { color: #0077b6; margin-bottom: 30px; text-align: center; }
    .form-label { font-weight: 500; }
    .btn-submit { background-color: #0288d1; color: white; font-weight: bold; border-radius: 8px; }
    .btn-submit:hover { background-color: #01579b; }
    #loadingScreen { display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(255, 255, 255, 0.8); z-index: 9999; justify-content: center; align-items: center; font-size: 1.5rem; color: #0077b6; font-weight: bold; }
  </style>
</head>
<body>
  <div id="loadingScreen">Loading... Please wait</div>
  <div class="container">
    <h2>Start Your Health Risk Prediction</h2>
    <form id="predictionForm" onsubmit="event.preventDefault(); handlePrediction();">
      <!-- Basic Info -->
      <div class="mb-3">
        <label class="form-label">Age</label>
        <input type="number" class="form-control" id="age" required>
      </div>
      <div class="mb-3">
        <label class="form-label">Gender</label>
        <select class="form-select" id="gender" required>
          <option selected disabled value="">Choose...</option>
          <option>Male</option>
          <option>Female</option>
          <option>Other</option>
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label">Height (cm)</label>
        <input type="number" step="0.1" class="form-control" id="height" required>
      </div>
      <div class="mb-3">
        <label class="form-label">Weight (kg)</label>
        <input type="number" step="0.1" class="form-control" id="weight" required>
      </div>
      <div class="mb-3">
        <label class="form-label">BMI</label>
        <input type="text" class="form-control" id="bmi" readonly>
      </div>
      <div class="mb-3">
        <label class="form-label">Average Hours of Sleep</label>
        <input type="number" step="0.1" class="form-control" id="sleepHours" required>
      </div>
      <!-- Lifestyle -->
      <div class="mb-3">
        <label class="form-label">Physical Activity Level</label>
        <select class="form-select" id="activity" required>
          <option selected disabled value="">Choose...</option>
          <option>Sedentary</option>
          <option>Lightly Active</option>
          <option>Moderately Active</option>
          <option>Very Active</option>
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label">Smoking Habit</label>
        <div class="form-check">
          <input class="form-check-input" type="radio" name="smoke" id="smokeYes" value="Yes" required>
          <label class="form-check-label" for="smokeYes">Yes</label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="radio" name="smoke" id="smokeNo" value="No">
          <label class="form-check-label" for="smokeNo">No</label>
        </div>
      </div>
      <div class="mb-3">
        <label class="form-label">Alcohol Consumption</label>
        <div class="form-check">
          <input class="form-check-input" type="radio" name="alcohol" id="alcoholYes" value="Yes" required>
          <label class="form-check-label" for="alcoholYes">Yes</label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="radio" name="alcohol" id="alcoholNo" value="No">
          <label class="form-check-label" for="alcoholNo">No</label>
        </div>
      </div>
      <div class="mb-3">
        <label class="form-label">Family History of Chronic Diseases</label>
        <select class="form-select" id="familyHistory" required>
          <option selected disabled value="">Choose...</option>
          <option>Yes</option>
          <option>No</option>
        </select>
      </div>
      <!-- BP and Diabetes indicators -->
      <div class="mb-3">
        <label class="form-label">Frequent Salt Intake?</label>
        <select class="form-select" id="saltIntake" required>
          <option selected disabled value="">Choose...</option>
          <option>Yes</option>
          <option>No</option>
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label">Frequent Stress or Anxiety?</label>
        <select class="form-select" id="stressLevel" required>
          <option selected disabled value="">Choose...</option>
          <option>Yes</option>
          <option>No</option>
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label">Exercise Regularly?</label>
        <select class="form-select" id="exercise" required>
          <option selected disabled value="">Choose...</option>
          <option>Yes</option>
          <option>No</option>
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label">Family History of High Blood Pressure?</label>
        <select class="form-select" id="bpFamilyHistory" required>
          <option selected disabled value="">Choose...</option>
          <option>Yes</option>
          <option>No</option>
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label">Frequent Urination or Thirst?</label>
        <select class="form-select" id="frequentUrine" required>
          <option selected disabled value="">Choose...</option>
          <option>Yes</option>
          <option>No</option>
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label">Fatigue or Excessive Hunger?</label>
        <select class="form-select" id="fatigue" required>
          <option selected disabled value="">Choose...</option>
          <option>Yes</option>
          <option>No</option>
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label">Blurred Vision or Slow-Healing Wounds?</label>
        <select class="form-select" id="visionIssue" required>
          <option selected disabled value="">Choose...</option>
          <option>Yes</option>
          <option>No</option>
        </select>
      </div>
      <button type="submit" class="btn btn-submit w-100">Predict</button>
    </form>
  </div>
  <script>
    function calculateBMI() {
      const h = parseFloat(document.getElementById("height").value);
      const w = parseFloat(document.getElementById("weight").value);
      if (h && w) {
        const bmi = w / Math.pow(h / 100, 2);
        document.getElementById("bmi").value = bmi.toFixed(1);
      } else {
        document.getElementById("bmi").value = "";
      }
    }
    document.getElementById("height").addEventListener("input", calculateBMI);
    document.getElementById("weight").addEventListener("input", calculateBMI);

    function handlePrediction() {
      const getValue = id => document.getElementById(id)?.value || "";
      const getRadio = name => document.querySelector(`input[name="${name}"]:checked`)?.value || "";

      const data = {
        age: getValue("age"),
        gender: getValue("gender"),
        height: getValue("height"),
        weight: getValue("weight"),
        bmi: getValue("bmi"),
        sleep: getValue("sleepHours"),
        activity: getValue("activity"),
        smoke: getRadio("smoke"),
        alcohol: getRadio("alcohol"),
        familyHistory: getValue("familyHistory"),
        saltIntake: getValue("saltIntake"),
        stressLevel: getValue("stressLevel"),
        exercise: getValue("exercise"),
        bpFamilyHistory: getValue("bpFamilyHistory"),
        frequentUrine: getValue("frequentUrine"),
        fatigue: getValue("fatigue"),
        visionIssue: getValue("visionIssue")
      };

      // Save all form data for chatbot
      localStorage.setItem("healthData", JSON.stringify(data));

      // Show loading screen
      document.getElementById("loadingScreen").style.display = "flex";

      setTimeout(() => {
        window.location.href = "/chatbot";
      }, 1000);
    }
  </script>
</body>
</html>